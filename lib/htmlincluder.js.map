{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/config.js","webpack:///./src/index.js","webpack:///./src/parse.js"],"names":["wrapFiles","insertFiles","pageFiles","options","devOptions","insertPattern","filePathAttribute","jsonPathAttribute","configureFiles","file","name","path","push","setOptions","ops","dev","module","exports","initialize","hashFile","f","formatFile","processClip","buildFileResult","map","processedFile","jsonInput","content","processed","callback","isWin","test","process","platform","contents","toString","trim","split","length","indexOf","splice","tmp","getDefaultNode","type","originalContent","parent","innerScope","children","nestedNodes","attributes","processFile","json","topNode","processNode","node","contentArr","splitContent","filter","c","buildNodes","resolveNode","closeTag","nodes","shift","findNodeType","slice","console","warn","forEach","joinContent","processor","nodeProcessors","loadNodeAttributes","attrs","nodeAttributes","reduce","acc","attr","hasTagAttribute","value","getTagAttribute","processRawJson","nodeList","join","textContent","insert","jsonPath","rawJson","filename","buildPathFromRelativePath","insertFile","newInnerScope","getDataFromJsonPath","insertNode","wrap","childNode","wrapFile","wrapNode","middle","data","defaultVal","default","values","jsonInsert","each","count","Array","isArray","jsonData","tmpContent","i","tmpChildren","if","getTagPositions","tag","lndx","ndx","buildTagPairs","open","close","divideContent","pairs","start","end","cursor","openTags","closeTags","pop","result","cur","toSafeJsonString","fixFilePathForOS","replace","cdir","fdir","dirChar","dir","e","JSON","stringify","jsonObj","jsonString","eval","error","fndx"],"mappings":"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","file":"htmlincluder.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/index.js\");\n","export const wrapFiles = {};\nexport const insertFiles = {};\nexport const pageFiles = [];\n\nexport let options = {};\nexport let devOptions = {};\nexport let insertPattern;\nexport let filePathAttribute;\nexport let jsonPathAttribute;\n\nexport const configureFiles = file => {\n  if(file.name[0] === '_')\n    wrapFiles[file.path] = file;\n  else if(file.name[0] === '-')\n    insertFiles[file.path] = file;\n  else\n    pageFiles.push(file);\n}\n\n// @options = (optional) options for configuring htmlIncluder\n// options.jsonInput         = A json object used to populate data in files\n// options.insertPattern     = The test looked for in order to insert files\n//          (this is so ssi includes can be used instead)\n// options.filePathAttribute = the name used for the file pathing for #insert\n//          and #wrap (default= 'path')\n// options.jsonPathAttribute = the name used for the file pathing for #insert\n//          , #wrap, #data, #jsonInsert (default= 'jsonPath')\n//\n//\n// options.dev.limitIterations = the number of times processFileWithJsonInput will loop\n// options.dev.printIterations = console log each processFileWithJsonInput loop\n// options.dev.printResult = console logs the final output\n// options.dev.printPaths = console logs the output of buildPathFromRelativePath\nexport const setOptions = ops => {\n  devOptions = ops.dev || {};\n  options = ops;\n\n  //set text value for insert tags, or default\n  insertPattern = (options.insertPattern)\n    ? '<!--#' + options.insertPattern\n    : '<!--#insert';\n\n  filePathAttribute = (options.filePathAttribute)\n    ? options.filePathAttribute\n    : 'path';\n\n  jsonPathAttribute = (options.jsonPathAttribute)\n    ? options.jsonPathAttribute\n    : 'jsonPath';\n}\n","import { configureFiles, setOptions, pageFiles, options } from './config';\nimport { processFile } from './parse';\n\nmodule.exports = {\n  initialize : options => setOptions(options),\n  // puts files into hash maps\n  hashFile : file => {\n    const f = formatFile(file);\n\n    // removing clip right away does no damage and speeds up later processing\n    processClip(f);\n\n    configureFiles(f);\n  },\n  // map on page files and build them into strings\n  buildFileResult : callback => pageFiles.map(file => {\n    const processedFile = processFile(file, options.jsonInput || {});\n    file.content = processedFile.content;\n\n    file.processed = true;\n\n    if(callback)\n      callback(file);\n\n    return file;\n  }),\n};\n\nconst isWin = /^win/.test(process.platform);\n\nconst formatFile = file => {\n  let f = {\n    path : file.path,\n    content : file.contents.toString('utf8').trim(),\n    processed : false,\n    file : file,\n  };\n\n  f.name = (isWin) ? file.path.split('\\\\') : file.path.split('/');\n  f.name = f.name[f.name.length-1];\n\n  return f;\n}\n\n// This runs first, since all of the clipped areas will completely be removed\nconst processClip = file => {\n  // process clipbefore and clipafter\n  if(file.content.indexOf('<!--#clipbefore') > -1) {\n    file.content = file.content\n      .split(/<!--#clipbefore\\s*-->/)\n      .splice(1)[0]\n      .split('<!--#clipafter')\n      .splice(0,1)[0];\n  }\n\n  // process clipbetween\n  if(file.content.indexOf('<!--#clipbetween') > -1) {\n    const tmp = file.content.split(/<!--#clipbetween\\s*-->/);\n    file.content = tmp[0] + tmp[1].split(/<!--#endclipbetween\\s*-->/)[1];\n  }\n}\n","import {\n  jsonPathAttribute,\n  filePathAttribute,\n  insertFiles,\n  wrapFiles,\n  options,\n  devOptions,\n  insertPattern,\n} from './config';\n\n// shape of our AST nodes\nconst getDefaultNode = () => ({\n  type            : '',\n  file            : {},\n  originalContent : '',\n  content         : '',\n  parent          : {},\n  innerScope      : null,\n  children        : [], // list of sequential nodes wrapped in tag (or at topNode)\n  nestedNodes     : [], // nested tags - these need to be resolved before this tag is resolved\n  attributes      : {}, // attributes on tag\n})\n\n// entry point for processing files\nexport const processFile = (file, json, parent, innerScope) => {\n  // convert string into object\n  const topNode = {\n    ...getDefaultNode(),\n    type    : 'topNode',\n    file,\n    originalContent : file.content,\n    content : file.content,\n    ...(parent     ? { parent }     : {}),\n    ...(innerScope ? { innerScope } : {}),\n  };\n\n  // don't do work if there are no tags in the file\n  if(topNode.originalContent.indexOf('<!--#') === -1)\n    return topNode;\n\n  // process children of the node\n  processNode(topNode, json);\n\n  return topNode;\n}\n\n//\nconst processNode = (node, json) => {\n  if(node.type === 'textContent') return node;\n\n  // the contents of a node may contain more nested nodes\n  // break these up into an array of mixed textContent nodes and tags\n  const contentArr = splitContent(node.content).filter(c => c !== '');\n\n  // convert array of strings to nodes\n  node.nestedNodes = buildNodes(node, contentArr, json);\n\n  return resolveNode(node, json);\n}\n\n//\nconst buildNodes = (parent, contentArr, json, closeTag) => {\n  const nodes = [];\n\n  while(contentArr.length > 0) {\n    const content = contentArr.shift();\n\n    // if we find the close tag, then we are done with our search\n    if(closeTag && content.indexOf(closeTag) === 0)\n      return nodes;\n\n    // lookup type of the tag\n    const type = findNodeType(content);\n\n    const node = {\n      ...getDefaultNode(),\n      type,\n      parent,\n      file            : parent.file,\n      innerScope      : parent.innerScope,\n      originalContent : content,\n      content,\n    };\n\n    // if this is a text node, we're set\n    if(type === 'textContent') {\n      nodes.push(node);\n      continue;\n    }\n\n    // remove leading character ('<') so the inner contents can be parsed properly\n    node.content = node.originalContent.slice(1);\n\n    // the contents inside a node can be treated like new little documents\n\n    // if this is a node that has children build them up, removing them\n    // from the split up array\n    node.children = (\n        type === 'wrap' ? buildNodes(node, contentArr, json, '<!--#endwrap')\n      : type === 'each' ? buildNodes(node, contentArr, json, '<!--#endeach')\n      : type === 'if'   ? buildNodes(node, contentArr, json, '<!--#endif')\n      : []\n    );\n\n    nodes.push(node);\n  }\n\n  // We should never get here while looking for a closing tag\n  if(closeTag)\n    console.warn(`WARNING while processing file '${parent.file.path}': there is a missing tag`);\n\n  return nodes;\n}\n\n//\nconst resolveNode = (node, json) => {\n  // resolve nested tags\n  if(node.nestedNodes.length > 0) {\n    node.nestedNodes.forEach(node => processNode(node, json));\n    node.content = joinContent(node.nestedNodes);\n  }\n\n  // process node so that content is resolved\n  const processor = nodeProcessors[node.type];\n\n  // There is a problem if we found no processor\n  if(!processor) {\n    console.warn(`WARNING while processing file '${node.file.path}': there is no processor for type '${node.type}'`);\n    return node;\n  }\n\n  // load and resolve attribute values\n  node.attributes = loadNodeAttributes(node);\n\n  return processor(node, json);\n}\n\n// loads values for tags into node object\nconst loadNodeAttributes = node => {\n  const attrs = nodeAttributes[node.type] || [];\n  return attrs.reduce((acc, attr) => {\n    if(hasTagAttribute(attr, node.content)) {\n      const value = getTagAttribute(attr, node.content);\n      acc[attr] = (attr === 'rawJson') ? processRawJson(value) : value;\n    }\n    return acc;\n  }, {})\n}\n\n// check for tag and return node type\nconst findNodeType = content => (\n  content.indexOf('<!--#insert')     === 0 ? 'insert'\n: content.indexOf('<!--#data')       === 0 ? 'data'\n: content.indexOf('<!--#jsonInsert') === 0 ? 'jsonInsert'\n: content.indexOf('<!--#wrap')       === 0 ? 'wrap'\n: content.indexOf('<!--#middle')     === 0 ? 'middle'\n: content.indexOf('<!--#each')       === 0 ? 'each'\n: content.indexOf('<!--#if')         === 0 ? 'if'\n: 'textContent'\n)\n\n//\nconst joinContent = nodeList => nodeList.map(c => c.content).join('')\n\n// the functions that processes each node\n// these assume that they have all their nested nodes resolved and attributes loaded\nconst nodeProcessors = {\n  //\n  topNode : (node, json) => {\n    node.content = joinContent(node.nestedNodes)\n    return node;\n  },\n  //\n  textContent : (node, json) => {\n    console.warn('WARNING: Why are we processing a textContent?');\n    return node;\n  },\n  //\n  insert : (node, json) => {\n    const { file, innerScope } = node;\n    const { path, jsonPath, rawJson } = node.attributes;\n    if(!path) {\n      console.warn(`WARNING while processing file '${file.path}': insert tag with no path attribute`);\n      node.content = '';\n      return node;\n    }\n\n    // get filename for inserted file\n    const filename = buildPathFromRelativePath(file.path, path);\n\n    // see if file we are loading exists\n    if(!insertFiles[filename]) {\n      console.warn(`WARNING while processing file '${file.path}': insert file '${filename}' does not exist`);\n      node.content = '';\n      return node;\n    }\n\n    // load contents from file\n    const insertFile = { ...insertFiles[filename] };\n\n    // set scope for inserted file\n    const newInnerScope = (\n        rawJson    && jsonPath ? getDataFromJsonPath(jsonPath, rawJson)\n      : innerScope && jsonPath ? getDataFromJsonPath(jsonPath, innerScope)\n      : rawJson  ? rawJson\n      : jsonPath ? getDataFromJsonPath(jsonPath, json)\n      : void(0)\n    );\n\n    const insertNode = processFile(insertFile, json, node, newInnerScope);\n\n    // process contents to get children\n    node.content = insertNode.content;\n    return node;\n  },\n  //\n  wrap : (node, json) => {\n    const { file, innerScope } = node;\n    const { path, jsonPath, rawJson } = node.attributes;\n    if(!path) {\n      console.warn(`WARNING while processing file '${node.file.path}': wrap tag with no path attribute`);\n      node.content = '';\n      return node;\n    }\n\n    // get filename for inserted file\n    const filename = buildPathFromRelativePath(file.path, path);\n\n    // see if file we are loading exists\n    if(!wrapFiles[filename]) {\n      console.warn(`WARNING while processing file '${node.file.path}': wrap file '${filename}' does not exist`);\n      node.content = '';\n      return node;\n    }\n\n    // we need to process the children before we bring in the file\n\n    // handle children content\n    node.children = node.children.map(childNode => processNode(childNode, json))\n    node.content = joinContent(node.children);\n\n    // load contents from file\n    const wrapFile = { ...wrapFiles[filename] };\n\n    // set scope for inserted file\n    const newInnerScope = (\n        rawJson    && jsonPath ? getDataFromJsonPath(jsonPath, rawJson)\n      : innerScope && jsonPath ? getDataFromJsonPath(jsonPath, innerScope)\n      : rawJson  ? rawJson\n      : jsonPath ? getDataFromJsonPath(jsonPath, json)\n      : void(0)\n    );\n\n    const wrapNode = processFile(wrapFile, json, node, newInnerScope);\n\n    // process contents to get children\n    node.content = wrapNode.content;\n    return node;\n  },\n  //\n  middle : (node, json) => {\n    node.content = node.parent.parent.content\n    return node;\n  },\n  //\n  data : (node, json) => {\n    const { innerScope, file } = node;\n    const { jsonPath, rawJson } = node.attributes;\n    const defaultVal = node.attributes.default;\n\n    if(!jsonPath || (!rawJson && !innerScope && !defaultVal)) {\n      console.warn(`WARNING while processing file '${file.path}': data tag with no data to look up for content '${node.originalContent}'`);\n      node.content = '';\n      return node;\n    }\n    const values = rawJson || innerScope;\n    const data = getDataFromJsonPath(jsonPath, values);\n    node.content = data || defaultVal || '';\n    return node;\n  },\n  //\n  jsonInsert : (node, json) => {\n    const { jsonPath } = node.attributes;\n    const defaultVal = node.attributes.default;\n    if(!jsonPath) {\n      node.content = '';\n      return node;\n    }\n    const data = getDataFromJsonPath(jsonPath, json);\n    node.content = data || defaultVal || '';\n    return node;\n  },\n  //\n  each : (node, json) => {\n    const { file, innerScope } = node;\n    const { count, jsonPath, rawJson } = node.attributes;\n    if(!count && !jsonPath && !Array.isArray(rawJson) && !Array.isArray(innerScope)) {\n      console.warn(`WARNING while processing file '${file.path}': each tag with attribute problems: count, jsonPath and rawJson and innerScope are not arrays`);\n      node.content = '';\n      return node;\n    }\n\n    // determine what data we are using\n    const values = rawJson || node.innerScope || json;\n    const jsonData = jsonPath ? getDataFromJsonPath(jsonPath, values) : void(0);\n    const data = (\n        Array.isArray(values)   ? values\n      : Array.isArray(jsonData) ? jsonData\n      : void(0)\n    );\n\n    if(!data && !count) {\n      node.content = '';\n      return node;\n    }\n\n    // build up nodes and bind the correct data\n    const tmpContent = [];\n    for(\n      let i = 0;\n         (!count || (count && i < count))\n      && (!data  || (data  && i < data.length));\n      i++)\n    {\n      // clone children\n      let tmpChildren = node.children.map(c => ({\n        ...c,\n        ...(c.nestedNodes ? { nestedNodes : c.nestedNodes} : { }),\n        ...(c.children    ? { children : c.children } : { }),\n        ...(data\n          // ? { innerScope : (typeof(data[i]) === 'object') ? { ...data[i] } : data[i] }\n          ? { innerScope : data[i] }\n          : { }\n        ),\n      }))\n      // handle children content\n      tmpChildren = tmpChildren.map(childNode => processNode(childNode, json))\n      tmpContent.push(joinContent(tmpChildren));\n    }\n\n    node.content = tmpContent.join('');\n    return node;\n  },\n  //\n  if : (node, json) => {\n    const { innerScope } = node;\n    const { jsonPath, rawJson } = node.attributes;\n    if(!jsonPath) {\n      node.content = '';\n      return node;\n    }\n\n    const values = rawJson || innerScope || json;\n    const jsonData = getDataFromJsonPath(jsonPath, values);\n    if(!jsonData) {\n      node.content = '';\n      return node;\n    }\n    node.children = node.children.map(childNode => {\n      return processNode({\n        ...childNode,\n        innerScope : { ...node.innerScope }\n      }, json);\n    })\n    node.content = joinContent(node.children);\n    return node;\n  },\n}\n\n// the legal attributes for each element\nconst nodeAttributes = {\n  insert      : [ 'path', 'jsonPath', 'rawJson' ],\n  data        : [ 'jsonPath', 'rawJson', 'default' ],\n  jsonInsert  : [ 'jsonPath', 'default' ],\n  wrap        : [ 'path', 'jsonPath', 'rawJson' ],\n  middle      : [  ],\n  each        : [ 'count', 'jsonPath', 'rawJson' ],\n  if          : [ 'jsonPath', 'rawJson' ],\n  textContent : [  ],\n}\n\nconst getTagPositions = (tag, content, lndx = 0, ndx = content.indexOf(tag)) => (\n(ndx === -1)\n    ? []\n    : [ ndx + lndx, ...getTagPositions(tag, content.slice(ndx + 1), lndx + ndx + 1) ]\n)\n\nconst buildTagPairs = (open, close) => (\n    (open.length === 0) ? []\n  : (open.length === 1 || open[1] > close[0]) ? [[open.slice(0, 1)[0], close.slice(0, 1)[0]], ...buildTagPairs(open.slice(1), close.slice(1))]\n  : [...buildTagPairs([...open.slice(0,1), ...open.slice(2)], close.slice(1))]\n)\n\nconst divideContent = (content, [start, end], pairs, cursor = 0) => (\n(start === void(0))\n  ? [content.slice(cursor)]\n  : [\n    content.slice(cursor, start),\n    content.slice(start, end+3),\n    ...divideContent(content, pairs.shift() || [], pairs, end+3)\n  ]\n)\n\nconst splitContent = content => {\n  const openTags  = getTagPositions('<!--#', content);\n  const closeTags = getTagPositions('-->', content);\n\n  if(openTags.length < closeTags.length) closeTags.pop();\n\n  const pairs = buildTagPairs(openTags, closeTags);\n\n  return divideContent(content, pairs.shift() || [], pairs).filter(c => c !== '');\n}\n\n// given a jsonObject and a path, return the data pointed at\nconst getDataFromJsonPath = (jsonPath, json) => {\n  if(jsonPath === 'this') return json;\n\n  let result = jsonPath.split('.').reduce((acc, cur) => acc ? acc[cur] : '', json)\n\n  if(!Array.isArray(result) && typeof(result) === 'object')\n    result = toSafeJsonString(result);\n\n  return result;\n}\n\n// are we on windows?\nconst isWin = /^win/.test(process.platform);\n\n// overcome the difference in *nix/windows pathing\nconst fixFilePathForOS = path =>\n  (isWin) ? path.replace(/\\//g, '\\\\') : path.replace(/\\\\/g, '/')\n\n// given the current directory and a relative path, build the complete path\n// to the relative path\nconst buildPathFromRelativePath = (cdir, fdir) => {\n  let dirChar = (isWin) ? '\\\\' : '/';\n  let dir = cdir.split(dirChar);\n  dir.pop();\n\n  fdir = fixFilePathForOS(fdir);\n\n  fdir.split(dirChar)\n    .forEach(function(e) {\n      (e === '..') ? dir.pop() : (e !== '.' && e !== '') ? dir.push(e) : void 0;\n    });\n  dir = dir.join(dirChar);\n\n  return dir;\n}\n\n//\nconst toSafeJsonString = jsonObj =>\n  JSON.stringify(jsonObj).replace(/\\'/g, \"\\\\'\").replace(/\"/g, \"'\")\n\n//\nconst processRawJson = jsonString => {\n  if(typeof(jsonString) === 'object')\n    jsonString = toSafeJsonString(jsonString);\n\n  let jsonData = {};\n  try {\n    eval('jsonData = ' + jsonString);\n  }\n  catch(e) {\n    console.error(`ERROR: Poorly formatted rawJson string:\n      ${jsonString}\n      This must be valid JavaScript.\n    `);\n  }\n\n  return jsonData;\n}\n\n// does a tag have an attribute? (attributeName=\"value\")\nconst hasTagAttribute =\n  (attr, content) => content.indexOf(attr + '=\"') > -1\n\n// get the value of an attribute (attributeName=\"value\")\nconst getTagAttribute = (attr, content) => {\n  let fndx = -1,\n      lndx = -1;\n\n  fndx = content.indexOf(attr + '=\"');\n  if(fndx === -1) {\n    console.warn(\"Warning: no tag of name `\" + attr + \"` found in the following content: `\" + content + \"`\")\n    return '';\n  }\n\n  content = content.slice(fndx + attr.length + 2);\n  lndx = content.indexOf('\"');\n  content = content.slice(0, lndx);\n  return content;\n}\n"],"sourceRoot":""}